#!/bin/bash

cat << "EOF"

........................................................................................................
:'##:::'##::::'###::::'##::::'##::::'###::::::::::'##:'####::::'########:::'#######:::'######:::'######::
::##::'##::::'## ##::: ###::'###:::'## ##::::::::: ##:. ##::::: ##.... ##:'##.... ##:'##... ##:'##... ##:
::##:'##::::'##:. ##:: ####'####::'##:. ##:::::::: ##:: ##::::: ##:::: ##: ##:::: ##: ##:::..:: ##:::..::
::#####::::'##:::. ##: ## ### ##:'##:::. ##::::::: ##:: ##::::: ##:::: ##: ##:::: ##: ##:::::::. ######::
::##. ##::: #########: ##. #: ##: #########:'##::: ##:: ##::::: ##:::: ##: ##:::: ##: ##::::::::..... ##:
::##:. ##:: ##.... ##: ##:.:: ##: ##.... ##: ##::: ##:: ##::::: ##:::: ##: ##:::: ##: ##::: ##:'##::: ##:
::##::. ##: ##:::: ##: ##:::: ##: ##:::: ##:. ######::'####:::: ########::. #######::. ######::. ######::
:..::::..::..:::::..::..:::::..::..:::::..:::......:::....::...........::::.......::::......::::......:::


EOF

command -v sphinx-build >/dev/null 2>&1 || { echo >&2 "WARNING! Can't find 'sphinx-build' binary!"; echo >&2 "Is your virtualenv activated?"; exit 1; }

if [ -z "$DJANGO_SETTINGS_MODULE" ]; then
    echo "#############################"
    echo "NO DJANGO_SETTINGS_MODULE SET"
    echo "#############################"

    while [[ -z "$DJANGO_SETTINGS" ]]
    do
        read -p "Enter Django settings (i.e. api.settings.xxx): " DJANGO_SETTINGS
    done

    export DJANGO_SETTINGS_MODULE=${DJANGO_SETTINGS}
fi

export LC_ALL=en_US.UTF-8
export LANG=en_US.UTF-8

echo "Building HTML docs"
make html

